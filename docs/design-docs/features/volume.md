# 概要

ボリューム機能を作成する.

# 対象範囲

## 達成基準

- ボリュームの作成, 更新, 削除, 取得ができる状態

## 除外項目

- ファイル機能は対応しない
- 認可機能は対応しない

# 利用方法

## エンドポイント

| パス | メソッド | 備考 |
| --- | --- | --- |
| /volumes | POST | ボリューム作成 |
| /volumes | GET | ボリューム一覧取得 |
| /volumes/:id | POST | ボリューム更新 |
| /volumes/:id | DELETE | ボリューム削除 |
| /volumes/:id | GET | ボリューム単体取得 |

# 詳細設計

## 要件

- ボリューム名と公開フラグを入力しボリュームの作成を行う
- ボリューム名と公開フラグの更新が行える
- ボリュームの削除が行える
- ボリュームの一覧, 単体取得が行える
  - 公開フラグがTrueの場合は認証無しでファイルの取得が行える

## 仕様

- ボリューム名はグローバルに一意となる
- ボリューム名は1文字以上255文字以下かつ\\/:*?"<>|は利用不可

## ドメインオブジェクト

| キー | 型 | 備考 |
| --- | --- | --- |
| id | uuid.UUID | |
| name | string | 1文字以上255文字以下<br />\\/:*?"<>\|は利用不可 |
| isPublic | bool | |
| createdAt | time.Time | |
| updatedAt | time.Time | |

## テーブル

| カラム名 | 型 | キー | null許容 | 備考 |
| --- | --- | --- | --- | --- |
| id | char(36) | PK | | ID |
| name | varchar(255) | UQ | | ボリューム名 |
| is_public | tinyint(1) | | | 公開フラグ |
| created_at | datetime(6) | | | 作成日時 |
| updated_at | datetime(6) | | | 更新日時 |

## テスト項目

### ボリューム名

#### 有効値判定

| ステータス | テストケース | 入力値 |
| --- | --- | --- |
| 正常系 | 小文字のローマ字のみ | name |
| 正常系 | 大文字のローマ字のみ | NAME |
| 正常系 | 数字のみ | 1234 |
| 正常系 | 小文字, 大文字, 数字の混在 | volumeName01 |
| 正常系 | 有効な記号が含まれる | !@#$%^&()_-+=[]{};',.~ |
| 正常系 | スペースが含まれる | volume name |
| 異常系 | スラッシュが含まれる | volume/name |
| 異常系 | バックスラッシュが含まれる | volume\name |
| 異常系 | コロンが含まれる | volume:name |
| 異常系 | アスタリスクが含まれる | volume*name |
| 異常系 | クエスションマークが含まれる | volume?name |
| 異常系 | ダブルクォーテーションが含まれる | volume"name |
| 異常系 | 大なり記号が含まれる | volume>name |
| 異常系 | 小なり記号が含まれる | volume<name |
| 異常系 | バーティカルバーが含まれる | volume\|name |
| 異常系 | ひらがな | なまえ |
| 異常系 | カタカナ | ナマエ |
| 異常系 | 漢字 | 名前 |
| 異常系 | 2文字 | strings.Repeat("a", 2) |
| 正常系 | 3文字 | strings.Repeat("a", 3) |
| 正常系 | 24文字 | strings.Repeat("a", 24) |
| 異常系 | 25文字 | strings.Repeat("a", 25) |

#### 重複判定

| ステータス | テストケース | 入力値 |
| --- | --- | --- |
| 正常系 | ボリュームが存在しない | 重複確認mockの戻り値がnil |
| 異常系 | ボリュームが存在する | 重複確認mockの戻り値がerror |

# その他の手法

# 参考文献

# 変更履歴

| 変更日 | 変更者 | 変更内容 |
| --- | --- | --- |
| 2025/04/20 | @atsumarukun | 初版 |
