# 概要

ボリューム機能を作成する.

# 対象範囲

## 達成基準

- ボリュームの各種操作を行うAPIが実装されている状態

## 除外項目

- エントリー機能は対応しない
- 認可機能は対応しない

# 利用方法

## エンドポイント

エンドポイントの詳細設計はSwagerUIにまとめる.

| パス | メソッド | 備考 |
| --- | --- | --- |
| /volumes | POST | ボリューム作成 |
| /volumes | GET | ボリューム一覧取得 |
| /volumes/:name | POST | ボリューム更新 |
| /volumes/:name | DELETE | ボリューム削除 |
| /volumes/:name | GET | ボリューム単体取得 |

# 詳細設計

## 要件

- ボリューム名と公開フラグを入力しボリュームの作成を行う
- ボリューム名と公開フラグの更新が行える
- ボリュームの削除が行える
  - エントリーが紐づいたボリュームの削除は行えない
- ボリュームの一覧, 単体取得が行える

## 仕様

- ボリューム名はグローバルに一意
- ボリューム名は1文字以上255文字以下かつ\\/:*?"<>|及び全角は利用不可
- ボリュームの作成時にファイルシステムにフォルダを作成する
- ボリュームの更新時にファイルシステムのフォルダを更新する
- ボリュームの削除時にファイルシステムのフォルダを削除する

## ドメインオブジェクト

| キー | 型 | 備考 |
| --- | --- | --- |
| ID | uuid.UUID | |
| AccountID | uuid.UUID | |
| Name | string | 1文字以上255文字以下<br />\\/:*?"<>\|及び全角は利用不可 |
| IsPublic | bool | |
| CreatedAt | time.Time | |
| UpdatedAt | time.Time | |

## テーブル

| カラム名 | 型 | キー | null許容 | 備考 |
| --- | --- | --- | --- | --- |
| id | char(36) | PK | | ID |
| account_id | char(36) | | | アカウントID |
| name | varchar(255) | UQ | | ボリューム名 |
| is_public | tinyint(1) | | | 公開フラグ |
| created_at | datetime(6) | | | 作成日時 |
| updated_at | datetime(6) | | | 更新日時 |

## テスト項目

| 項目 | 内容 |
| --- | --- |
| ボリュームの初期化 | ドメインオブジェクトの初期化を確認 |
| ボリューム名の有効値判定 | 有効値と無効値の判定<br />文字数の境界値判定 |
| ボリューム名の重複判定 | ボリューム名重複時の判定 |
| 実行されるSQL | インフラ層で実行されるSQLの確認 |
| 実行される関数 | 実行される下位レイヤの関数を確認 |
| 戻り値 | 関数の戻り値を確認 |
| エラーハンドリング | エラー発生時のハンドリングを確認 |

# その他の手法

# 参考文献

# 変更履歴

| 変更日 | 変更者 | 変更内容 |
| --- | --- | --- |
| 2025/04/20 | @atsumarukun | 初版 |
